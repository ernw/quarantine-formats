# Malwarebytes

## Location of quarantine files

TODO

## Files and file name structure

The name seems to consist of a UUID:

`[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}.quar`

and 

`[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}.data`

For every quarantined file there is one .quar and one .data file. The .quar file contains the encrypted malicious file, the .data file contains an encrypted JSON file with metadata.


## Structure of quarantine files

### Quar files

Decrypting the file using RC4 (see below for key) results in the quarantined file.


### Data files

A .data file may look like this after decrypting it using RC4 (see below for key):

```json
{
   "componentsUpdatePackageVersion" : "1.0.613",
   "dbSDKUpdatePackageVersion" : "1.0.12023",
   "ruleID" : 683363,
   "ruleString" : "",
   "schemaVersion" : 8,
   "source" : "scan",
   "sourceID" : "<UUID>",
   "sourcePath" : "<PATH>",
   "threatID" : 3912,
   "threatName" : "<TYPE OF MALWARE>",
   "trace" : {
      "cleanAction" : "quarantine",
      "cleanContext" : {
      },
      "cleanResult" : "successful",
      "cleanResultErrorCode" : 0,
      "cleanTime" : "2019-08-15T11:35:10Z",
      "objectID" : "<UUID WHICH IS ALSO PART OF FILE NAME>",
      "objectMD5" : "<MD5 HASH>",
      "objectPath" : "<ORIGINAL FILE PATH>",
      "objectSha256" : "<SHA256 HASH>",
      "objectType" : "file",
      "parentID" : "",
      "relationToParent" : "none",
      "suggestedAction" : {
         "chromeExtensionOther" : false,
         "chromeExtensionPreferences" : false,
         "chromeExtensionSecurePreferences" : false,
         "chromeExtensionSyncData" : false,
         "chromeUrlOther" : false,
         "chromeUrlSecurePreferences" : false,
         "chromeUrlSyncData" : false,
         "chromeUrlWebData" : false,
         "fileDelete" : true,
         "fileReplace" : false,
         "fileTxtReplace" : false,
         "folderDelete" : false,
         "isChromeObject" : false,
         "isDDS" : false,
         "isWMIEventConsumer" : false,
         "minimalWhiteListing" : false,
         "moduleUnload" : false,
         "noLinking" : false,
         "physicalSectorReplace" : false,
         "priorityHigh" : false,
         "priorityNormal" : false,
         "priorityUrgent" : false,
         "processUnload" : false,
         "regKeyDelete" : false,
         "regValueDelete" : false,
         "regValueReplace" : false,
         "shortcutReplace" : false,
         "treatAsRootkit" : false,
         "useDDA" : false
      }
   }
}
``` 


## RC4 decryption key

The key can be created by creating an MD5 hash of the following string:

```
digest = [int(b) for b in md5(
        'Go9r%8hhAl7Ari;vnQ8wwkmeostfETkzLEf5*+6u8MF.CbsYKbTt9w.cVJbJ+pzyvrsT'
        .encode()).digest()]
```
